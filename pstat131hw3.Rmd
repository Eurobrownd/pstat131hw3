---
title: "pstat131hw3"
author: "Simon Lee"
date: "2022-10-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r message = FALSE}
library(tidyverse)
library(tidymodels)
library(discrim)
library(poissonreg)
library(corrr)
library(klaR)
library(corrplot)
library(corrr)
```

```{r}
tidymodels_prefer()
titanic_data <- read.csv("data/titanic.csv")
titanic_data$survived <- as.factor(titanic_data$survived)
titanic_data$survived <- relevel(titanic_data$survived, "Yes")
titanic_data$pclass <- as.factor(titanic_data$pclass)
head(titanic_data)
```

# q1
```{r}
set.seed(115)

titanic_split <- initial_split(titanic_data, prop = 0.8, strata = survived)
titanic_train <- training(titanic_split)
titanic_test <- testing(titanic_split)

colSums(is.na(titanic_train)) / nrow(titanic_train)
```
From looking at the training and testing sets, there are 3 varibles with missing data
That being age at 0.189, cabin at 0.775, and embarked at 14.05
Stratifying the data on survived allows us to make models that don't include survived
as a prediction variable. And it gives us a sample of the data that represents the population

# q2
```{r}
titanic_train %>% ggplot(aes(x= survived)) + geom_bar()
```
From the distribution, it seems that less people survived than those that died

# q3
```{r}
titanic_cor <- titanic_train %>% 
  select(-c(survived, pclass, sex, embarked, name, ticket, cabin)) %>% 
  correlate()
```